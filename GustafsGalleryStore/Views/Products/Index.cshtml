@model GustafsGalleryStore.Models.ViewModels.ProductListViewModel
@{
    ViewData["Title"] = "Products";
}
<div class="w3-row">
    <div class="w3-bar-block w3-light-grey w3-card w3-animate-left w3-quarter" style="display:none" id="filterSidebar">
        <div class="w3-row">
            <button class="w3-button w3-half" onclick="filterClose()">Close</button>
            <button class="w3-button w3-half" onclick="openModal('spin');updateFilter('/Products?');">Update</button>
        </div>
        <div class="w3-block w3-center w3-dark-grey">Filter Designer</div>
        <div id="brands" class="filter-block">
            @foreach (var brand in Model.Brands)
            {
                <div class="w3-button w3-block" onclick="filterButtonClick(this)">
                    @if (Model.FilteredBrands.Contains(brand.Brand))
                    {
                        <input type="checkbox" checked />
                    }
                    else
                    {
                        <input type="checkbox" />
                    }
                    &nbsp;<label>@brand.Brand</label>
                </div>
            }
        </div>
        <div class="w3-block w3-center w3-dark-grey">Filter Department</div>
        <div id="department" class="filter-block">
            @foreach (var dept in Model.Departments)
            {
                <div class="w3-button w3-block" onclick="filterButtonClick(this)">
                    @if (Model.FilteredDepartments.Contains(dept.DepartmentName))
                    {
                        <input type="checkbox" checked />
                    }
                    else
                    {
                        <input type="checkbox" />
                    }
                    &nbsp;<label>@dept.DepartmentName</label>
                </div>
            }
        </div>
    </div>

    <div id="mainContent">
        <div class="w3-bar w3-padding">
            <button id="openNav" class="w3-button w3-light-grey w3-round" onclick="filterOpen()"><i class="fas fa-filter w3-margin-right"></i>Filter</button>
            @if (Model.FilteredBrands.Count > 0 || Model.FilteredDepartments.Count > 0)
            {
                <a href="/Products" class="w3-button w3-light-grey w3-round w3-margin-left" onclick="openModal('spin');"><i class="fas fa-sync-alt w3-margin-right"></i>Clear Filter</a>
            }
        </div>
        <table id="products">
            <thead>
                <tr>
                    <th></th>
                    <th class="w3-hide-small">Designer</th>
                    <th class="w3-hide-small">Department</th>
                    <th class="w3-hide-small"></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var member in Model.Products)
                {
                    <tr>
                        <td class="w3-center" style="max-width: 200px;">
                            @*<p class="" style="width: 200px;"><a href="/Products/Product?id=@member.Id" class="edit" data-message-id="@member.Id">@member.Title</a></p>
                                @if (member.ProductImages.Count > 0)
                                {
                                    <a href="/Products/Product?id=@member.Id" class="edit" data-message-id="@member.Id"><img class="w3-hover-opacity-off w3-opacity" style="max-width: 200px;" src="@member.ProductImages[0].Uri" /></a>
                                }*@

                            <a href="/Products/Product?id=@member.Id" class="edit" data-message-id="@member.Id">
                                @if (member.ProductImages.Count > 0)
                                {
                                    <img class="w3-hover-opacity-off w3-opacity" style="max-width: 200px;" src="@member.ProductImages[0].Uri" />
                                }
                                <br /> @member.Title
                            </a>
                        </td>
                        <td class="w3-center w3-hide-small">@member.ProductBrand.Brand</td>
                        <td class="w3-center w3-hide-small">@member.Department.DepartmentName</td>
                        <td class="w3-center w3-hide-small" style="width: 100px">
                            <b>£@member.Price</b>
                            <p>
                                <a class="w3-bar-item w3-button w3-round w3-light-grey w3-block" href="/Products/Product?id=@member.Id" onclick="openModal('spin');"><i class="fas fa-eye w3-margin-right"></i>More Detail</a>
                            </p>
                            <p>
                                @if (member.ProductSizes.Count == 1 && member.ProductColours.Count == 1)
                                {

                                    <button class="w3-bar-item w3-button w3-round w3-light-grey w3-block" onclick="addToBasket(@member.Id,'@member.ProductSizes[0].Size','@member.ProductColours[0].Colour')"><i class="fas fa-cart-plus w3-margin-right"></i>Add To Basket</button>
                                }
                                else
                                {
                                    <a class="w3-bar-item w3-button w3-round w3-light-grey w3-block" href="/Products/Product?id=@member.Id" onclick="openModal('spin');"><i class="fas fa-cart-plus w3-margin-right"></i>Add To Basket</a>
                                }
                            </p>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div id="basket-modal" class="w3-modal" style="z-index:4">
    <span class="w3-button w3-large w3-display-topright" title="Close Image" onclick="closeModal('discount-code-modal')"><i class="fa fa-times w3-text-white"></i></span>
    <div class="w3-modal-content w3-animate-zoom">
        <div class="w3-container w3-padding">
            <div class="w3-container w3-padding-large">
                <h2 id="title"></h2>
                <h4 id="brand"></h4>
            </div>
        </div>
    </div>
</div>

<script>$("#products").DataTable();</script>
<script src="https://dmm8i98ipy9lm.cloudfront.net/addToBasketCodev2.min.js?Authorization"></script>
<script src="https://dmm8i98ipy9lm.cloudfront.net/filterProducts.min.js?Authorization"></script>
